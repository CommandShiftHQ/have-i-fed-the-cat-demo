<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <link rel="stylesheet" href="../css/index.css" />
  <link rel="stylesheet" href="../css/content-container.css" />
  <link rel="stylesheet" href="../css/content-card.css" />
  <link rel="stylesheet" href="../css/column-container.css" />
  <link rel="stylesheet" href="../css/row-container.css" />
  <title>Have I Fed The Cat?</title>
</head>
<body>
  <nav>
    <h1>Have I Fed The Cat?</h1>
    <a href="/">Cats</a>
  </nav>
  <main>
    <div id="content-container" ></div>
  </main>
</body>
<script src="../js/get-cat.js"></script>
<script src="../js/format-date.js"></script>
<script src="../js/feed-cat.js"></script>
<script>
  // immediately invoked function expression - IIFE
  (async () => {
    const urlParams = new URLSearchParams(window.location.search);
    const catId = urlParams.get('catId');

    const cat = catId ? await getCat(catId) : null;
    const contentElement = document.getElementById('content-container')

    const cardElement = document.createElement('div');
      cardElement.className = 'content-card';

    if (cat) {
      const { name, breed, markings, lastFed, profileImage } = cat;

      const lastFedString = lastFed ? formatDate(lastFed): 'never :(';

      const columnContainer = document.createElement('div');
      columnContainer.className = 'column-container';

      const rowContainer = document.createElement('div');
      rowContainer.className = 'row-container';

      const catNameTitleElement = document.createElement('h1');
      catNameTitleElement.textContent = name;

      const catBreedTextElement = document.createElement('span');
      catBreedTextElement.innerHTML= `<b>Breed</b>: ${breed}`;

      const catMarkingsTextElement = document.createElement('span');
      catMarkingsTextElement.innerHTML = `<b>Markings</b>: ${markings}`;

      const lastFedTextElement = document.createElement('span');
      lastFedTextElement.innerHTML = `<b>Last Fed</b>: ${lastFedString}`;

      const catPictureElement = document.createElement('img');
      catPictureElement.src = profileImage ? profileImage : 'http://placekitten.com/200/200';

      const feedCatButtonElement = document.createElement('button');
      feedCatButtonElement.textContent = `Feed ${name}`
      feedCatButtonElement.onclick = () => feedCat(catId);

      columnContainer.appendChild(catBreedTextElement);
      columnContainer.appendChild(catMarkingsTextElement);
      columnContainer.appendChild(lastFedTextElement);
      columnContainer.appendChild(feedCatButtonElement);

      rowContainer.appendChild(catPictureElement);
      rowContainer.appendChild(columnContainer);

      cardElement.appendChild(catNameTitleElement);
      cardElement.appendChild(rowContainer)
    } else {

      const notFoundTitleElement = document.createElement('h1');
      notFoundTitleElement.textContent = '404';

      const notFoundMessageElement = document.createElement('h3');
      notFoundMessageElement.textContent = 'cat does not exist';

      cardElement.appendChild(notFoundTitleElement);
      cardElement.appendChild(notFoundMessageElement);
    }

    contentElement.appendChild(cardElement);
  })()
</script>
</html>